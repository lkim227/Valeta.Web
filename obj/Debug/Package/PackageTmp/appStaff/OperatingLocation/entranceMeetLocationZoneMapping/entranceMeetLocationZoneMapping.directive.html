<style>
    /* override kendo cell value selector box */
    div.k-animation-container {
        width: 100px !important;
    }
</style>

<div ng-show="!!operatingLocationIdParam">
    <div class="page-controls-wrapper">
        <get-operating-location-data operating-location-identifier="operatingLocationIdParam" operating-location-object="operatingLocation"></get-operating-location-data>
        <a ui-sref="setup-operatinglocations" class="link">Back to {{operatingLocation.Name}}</a>

        <button class="k-button btn btn-primary left-buffer30 k-state-disabled" id="save" ng-if="canCreate && canUpdate && canDelete" ng-click="onSave()">Save</button>
        <label class="alert alert-info hidden" id="save-message" ng-if="canCreate && canUpdate && canDelete">Spreadsheet has unsaved changes</label>
        <label class="alert alert-danger" ng-show="emptyEntranceNameError === true">One or more rows contain an empty EntranceName value. Please update spreadsheet.</label>
        <label class="alert alert-danger" ng-show="emptyMeetLocationError === true">One or more rows contain an empty MeetLocation value. Please update spreadsheet.</label>
        <label class="alert alert-danger" ng-show="emptyZoneCodeError === true">One or more rows contain an empty ZoneCode value. Please update spreadsheet.</label>

        <div class="fullrow left-buffer40" ng-show="invalidEntranceNameValues.length > 0">
            <br />
            <label class="alert alert-danger">The following Entrance Names inserted are invalid. Please update spreadsheet.</label>
            <div ng-repeat="entrance in invalidEntranceNameValues | orderBy: 'toString()'">
                <label class="form-col-withlabel-label control-label">- {{ entrance }}</label>
            </div>
        </div>
        <div class="fullrow left-buffer40" ng-show="invalidMeetLocationValues.length > 0">
            <br />
            <label class="alert alert-danger">The following Meet Locations are invalid. Please update spreadsheet or add to a list of valid Meet Locations.</label>
            <div ng-repeat="meetLocation in invalidMeetLocationValues | orderBy: 'toString()'">
                <label class="form-col-withlabel-label control-label">- {{ meetLocation }}</label>
                <button class="btn btn-sm bottom-buffer15" id="insertNewMeetLocation" ng-click="insertNewMeetLocation(meetLocation, $index)">Add to Meet Locations</button>
            </div>
        </div>
        <div class="fullrow left-buffer40" ng-show="invalidZoneCodes.length > 0">
            <br />
            <label class="alert alert-danger">The following Zone Codes are invalid. Please update spreadsheet.</label>
            <div ng-repeat="zoneCode in invalidZoneCodes | orderBy: 'toString()'">
                <label class="form-col-withlabel-label control-label">- {{ zoneCode }}</label>
                <button class="btn btn-sm bottom-buffer15" id="insertNewZoneCode" ng-click="insertNewZoneCode(zoneCode, $index)">Add to Zones</button>
            </div>
        </div>

        <span class="left-buffer5">After editing a cell, click outside of it and then click Save Changes button.</span>
    </div>
    
    <div class="fullrow">
        <kendo-spreadsheet class="width-full" id="spreadsheet" k-options="sheetOptions"></kendo-spreadsheet>
    </div>
</div>
